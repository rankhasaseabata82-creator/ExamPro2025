<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Examiner Dashboard</title>
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.10.5/font/bootstrap-icons.css">

  <style>
    .correct-option { border: 2px solid #198754 !important; }
  </style>
</head>
<body class="bg-light">

<nav class="navbar navbar-expand-lg navbar-dark bg-primary shadow-sm">
  <div class="container-fluid">
    <span class="navbar-brand mb-0 h1">
      <i class="bi bi-clipboard-data me-2"></i>Examiner Dashboard
    </span>
    <a href="Index.html" class="btn btn-sm btn-outline-light">
      <i class="bi bi-house-door"></i> Home
    </a>
  </div>
</nav>

  <ul class="nav nav-pills mb-4" id="examinerTab" role="tablist">
    <li class="nav-item" role="presentation">
      <button class="nav-link active" id="set-questions-tab" data-bs-toggle="pill"
              data-bs-target="#set-questions" type="button" role="tab">
        <i class="bi bi-patch-question"></i> Set Questions
      </button>
    </li>
    <li class="nav-item" role="presentation">
      <button class="nav-link" id="view-marks-tab" data-bs-toggle="pill"
              data-bs-target="#view-marks" type="button" role="tab">
        <i class="bi bi-bar-chart-line"></i> View Marks
      </button>
    </li>
  </ul>

  <div class="tab-content" id="examinerTabContent">
    <div class="tab-pane fade show active" id="set-questions" role="tabpanel">
      <div class="card shadow-sm">
        <div class="card-header bg-primary text-white">
          Add New Question
        </div>
        <div class="card-body">
          <form id="questionForm">
            <div class="mb-3">
              <label class="form-label">Question</label>
              <textarea class="form-control" name="questionText" rows="2" required></textarea>
            </div>

            <div class="row mb-2">
              <div class="col-md-6">
                <label class="form-label">Option A</label>
                <input type="text" class="form-control" name="optA" required>
              </div>
              <div class="col-md-6">
                <label class="form-label">Option B</label>
                <input type="text" class="form-control" name="optB" required>
              </div>
            </div>
            <div class="row mb-3">
              <div class="col-md-6">
                <label class="form-label">Option C</label>
                <input type="text" class="form-control" name="optC" required>
              </div>
              <div class="col-md-6">
                <label class="form-label">Option D</label>
                <input type="text" class="form-control" name="optD" required>
              </div>
            </div>

            <div class="mb-3">
              <label class="form-label">Correct Answer</label>
              <select class="form-select" name="correct" required>
                <option value="" disabled selected>Choose...</option>
                <option value="A">A</option>
                <option value="B">B</option>
                <option value="C">C</option>
                <option value="D">D</option>
              </select>
            </div>

            <button type="submit" class="btn btn-success">
              <i class="bi bi-check-circle"></i> Save Question
            </button>
          </form>
        </div>
      </div>

      
      <div class="card shadow-sm mt-4">
        <div class="card-header bg-secondary text-white">
          Questions Bank (<span id="qCount">0</span>)
        </div>
        <ul class="list-group list-group-flush" id="questionList"></ul>
      </div>
    </div>

    
    <div class="tab-pane fade" id="view-marks" role="tabpanel">
      <div class="card shadow-sm">
        <div class="card-header bg-info text-white">
          Students' Scores
        </div>
        <div class="card-body px-0">
          <div class="table-responsive">
            <table class="table table-hover mb-0 align-middle">
              <thead class="table-light">
                <tr>
                  <th>#</th>
                  <th>Student</th>
                  <th>Exam</th>
                  <th>Score</th>
                  <th class="d-none d-md-table-cell">Date</th>
                  <th></th>
                </tr>
              </thead>
              <tbody id="marksTableBody"></tbody>
            </table>
          </div>
        </div>
      </div>
    </div>
  </div>
</div>

<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js"></script>

<script>

let questions = [
  {id: 1, text:"What is 2+2?", optA:"3", optB:"4", optC:"5", optD:"6", correct:"B"},
  {id: 2, text:"Capital of France?", optA:"Paris", optB:"London", optC:"Berlin", optD:"Madrid", correct:"A"}
];
let marks = [
  {id:1, student:"Alice", exam:"Math", score:87, date:"2025-11-09"},
  {id:2, student:"Bob",   exam:"Math", score:92, date:"2025-11-09"},
  {id:3, student:"Carol", exam:"Bio",  score:78, date:"2025-11-08"}
];

function renderQuestions(){
  const list = document.getElementById('questionList');
  list.innerHTML = '';
  questions.forEach(q=>{
    const li = document.createElement('li');
    li.className='list-group-item';
    li.innerHTML = `
      <div class="d-flex justify-content-between align-items-center">
        <div>
          <div class="fw-bold">${q.text}</div>
          <small class="text-muted">A: ${q.optA} | B: ${q.optB} | C: ${q.optC} | D: ${q.optD} | Correct: <span class="text-success">${q.correct}</span></small>
        </div>
        <button class="btn btn-sm btn-outline-danger" onclick="deleteQuestion(${q.id})"><i class="bi bi-trash"></i></button>
      </div>`;
    list.appendChild(li);
  });
  document.getElementById('qCount').textContent = questions.length;
}
function renderMarks(){
  const tbody = document.getElementById('marksTableBody');
  tbody.innerHTML = marks.map((m,i)=>`
    <tr>
      <td>${i+1}</td>
      <td>${m.student}</td>
      <td>${m.exam}</td>
      <td><span class="badge bg-primary">${m.score}%</span></td>
      <td class="d-none d-md-table-cell">${m.date}</td>
      <td><button class="btn btn-sm btn-outline-secondary">Detail</button></td>
    </tr>`).join('');
}

document.getElementById('questionForm').addEventListener('submit', e=>{
  e.preventDefault();
  const f = e.target;
  const newQ = {
    id: questions.length ? questions[questions.length-1].id+1 : 1,
    text: f.questionText.value.trim(),
    optA: f.optA.value.trim(),
    optB: f.optB.value.trim(),
    optC: f.optC.value.trim(),
    optD: f.optD.value.trim(),
    correct: f.correct.value
  };
  questions.push(newQ);
  renderQuestions();
  f.reset();
});
function deleteQuestion(id){
  questions = questions.filter(q=>q.id!==id);
  renderQuestions();
}


renderQuestions();
renderMarks();


const liveMarks = []; 
const bc = new BroadcastChannel('exam_results');
bc.onmessage = (e) => {
  liveMarks.unshift(e.data); 
  renderLiveMarks();
};

function renderLiveMarks() {
  const tbody = document.getElementById('marksTableBody');
  tbody.innerHTML = liveMarks.map((m, i) => `
    <tr>
      <td>${i + 1}</td>
      <td>${m.student}</td>
      <td>${m.exam}</td>
      <td><span class="badge bg-primary">${m.score}%</span></td>
      <td class="d-none d-md-table-cell">${m.date}</td>
      <td><button class="btn btn-sm btn-outline-secondary">Detail</button></td>
    </tr>`).join('');
}


renderLiveMarks();
function renderQuestions(){
 
  document.getElementById('qCount').textContent = questions.length;

  const bc = new BroadcastChannel('exam_data');
  bc.postMessage(questions);   
}
</script>
</body>
</html>